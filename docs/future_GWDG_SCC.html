<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Ruben Arslan" />

<meta name="date" content="2017-10-30" />

<title>try</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
div.sourceCode {
  overflow-x: visible;
}
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 64px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 69px;
  margin-top: -69px;
}

.section h2 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h3 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h4 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h5 {
  padding-top: 69px;
  margin-top: -69px;
}
.section h6 {
  padding-top: 69px;
  margin-top: -69px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("future_GWDG_SCC.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Trying the future package</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Overview</a>
</li>
<li>
  <a href="future_ARC_Rserver.html">ARC R Server</a>
</li>
<li>
  <a href="future_MPIB_tardis.html">MPIB Tardis</a>
</li>
<li>
  <a href="future_GWDG_SCC.html">GWDG SCC</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rubenarslan/try_future">
    <span class="fa fa-github"></span>
     
    
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">try</h1>
<h4 class="author"><em>Ruben Arslan</em></h4>
<h4 class="date"><em>30 October 2017</em></h4>

</div>


<div id="future-package" class="section level2">
<h2>Future package</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># vignette(&quot;future-1-overview&quot;)</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(future)</a></code></pre></div>
</div>
<div id="gwdg-cluster" class="section level2">
<h2>GWDG cluster</h2>
<p>To run jobs on a cluster, you need to use a job scheduler. For this, you need a second package <code>future.batchtools</code>. Further, you need to copy a template file for job scripts to the server.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;future&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;listenv&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">library</span>(<span class="st">&quot;future.batchtools&quot;</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">library</span>(debugme)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">Sys.setenv</span>(<span class="dt">DEBUGME=</span><span class="st">&#39;batchtools&#39;</span>)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw">library</span>(batchtools)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">## Set up access to remote login node</a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co"># login_vpn &lt;- tweak(remote, workers = &quot;rarslan@login.gwdg.de&quot;) # doesn&#39;t work because R not installed</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">login &lt;-<span class="st"> </span><span class="kw">tweak</span>(remote, <span class="dt">workers =</span> <span class="st">&quot;gwdu102.gwdg.de&quot;</span>, <span class="dt">user =</span> <span class="st">&#39;rarslan&#39;</span>)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">bsub &lt;-<span class="st"> </span><span class="kw">tweak</span>(batchtools_lsf, <span class="dt">template =</span> <span class="st">&#39;lsf.tmpl&#39;</span>, </a>
<a class="sourceLine" id="cb2-12" data-line-number="12">            <span class="co"># workers = &quot;export LSF_ENVDIR=/opt/lsf/conf&quot;,</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">                <span class="dt">resources =</span> <span class="kw">list</span>(<span class="dt">job.name =</span> <span class="st">&#39;test1&#39;</span>,</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">                                <span class="dt">log.file =</span> <span class="st">&#39;blaaa2.log&#39;</span>,</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">                                <span class="dt">queue =</span> <span class="st">&#39;mpi&#39;</span>,</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">                                <span class="dt">walltime =</span> <span class="st">&#39;1:00&#39;</span>,</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">                                <span class="dt">processes =</span> <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb2-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">## Specify future topology</a>
<a class="sourceLine" id="cb2-20" data-line-number="20">## login node -&gt; { cluster nodes } -&gt; { multiple cores }</a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="kw">plan</span>(<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb2-22" data-line-number="22">  login,</a>
<a class="sourceLine" id="cb2-23" data-line-number="23">  bsub,</a>
<a class="sourceLine" id="cb2-24" data-line-number="24">  multicore</a>
<a class="sourceLine" id="cb2-25" data-line-number="25">))</a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co"># demo(&quot;mandelbrot&quot;, package = &quot;future&quot;, ask = FALSE)</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"></a>
<a class="sourceLine" id="cb2-28" data-line-number="28">x <span class="op">%&lt;-%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb2-29" data-line-number="29">  thost &lt;-<span class="st"> </span><span class="kw">Sys.info</span>()[[<span class="st">&quot;nodename&quot;</span>]]</a>
<a class="sourceLine" id="cb2-30" data-line-number="30">  tpid &lt;-<span class="st"> </span><span class="kw">Sys.getpid</span>()</a>
<a class="sourceLine" id="cb2-31" data-line-number="31">  <span class="co"># set_gwdg_env()</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32">  y &lt;-<span class="st"> </span><span class="kw">listenv</span>()</a>
<a class="sourceLine" id="cb2-33" data-line-number="33">  <span class="cf">for</span> (task <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb2-34" data-line-number="34">    ## (b) This will be evaluated on a compute node on the cluster</a>
<a class="sourceLine" id="cb2-35" data-line-number="35">    y[[task]] <span class="op">%&lt;-%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb2-36" data-line-number="36">      mhost &lt;-<span class="st"> </span><span class="kw">Sys.info</span>()[[<span class="st">&quot;nodename&quot;</span>]]</a>
<a class="sourceLine" id="cb2-37" data-line-number="37">      mpid &lt;-<span class="st"> </span><span class="kw">Sys.getpid</span>()</a>
<a class="sourceLine" id="cb2-38" data-line-number="38">      z &lt;-<span class="st"> </span><span class="kw">listenv</span>()</a>
<a class="sourceLine" id="cb2-39" data-line-number="39">      <span class="cf">for</span> (jj <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {</a>
<a class="sourceLine" id="cb2-40" data-line-number="40">        ## (c) These will be evaluated in separate processes on the same compute node</a>
<a class="sourceLine" id="cb2-41" data-line-number="41">        z[[jj]] <span class="op">%&lt;-%</span><span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">task =</span> task,</a>
<a class="sourceLine" id="cb2-42" data-line-number="42">                                <span class="dt">top.host =</span> thost, <span class="dt">top.pid =</span> tpid,</a>
<a class="sourceLine" id="cb2-43" data-line-number="43">                                <span class="dt">mid.host =</span> mhost, <span class="dt">mid.pid =</span> mpid,</a>
<a class="sourceLine" id="cb2-44" data-line-number="44">                                <span class="dt">host =</span> <span class="kw">Sys.info</span>()[[<span class="st">&quot;nodename&quot;</span>]],</a>
<a class="sourceLine" id="cb2-45" data-line-number="45">                                <span class="dt">pid =</span> <span class="kw">Sys.getpid</span>())</a>
<a class="sourceLine" id="cb2-46" data-line-number="46">      }</a>
<a class="sourceLine" id="cb2-47" data-line-number="47">      <span class="kw">Reduce</span>(rbind, z)</a>
<a class="sourceLine" id="cb2-48" data-line-number="48">    }</a>
<a class="sourceLine" id="cb2-49" data-line-number="49">  }</a>
<a class="sourceLine" id="cb2-50" data-line-number="50">  <span class="kw">Reduce</span>(rbind, y)</a>
<a class="sourceLine" id="cb2-51" data-line-number="51">}</a>
<a class="sourceLine" id="cb2-52" data-line-number="52"></a>
<a class="sourceLine" id="cb2-53" data-line-number="53"><span class="kw">print</span>(x)</a></code></pre></div>
<pre><code>##   task top.host top.pid mid.host mid.pid   host   pid
## 1    1  gwdu102    8997   dfa015    4389 dfa015  4400
## 2    1  gwdu102    8997   dfa015    4389 dfa015  4413
## 3    2  gwdu102    8997   dfa013   23086 dfa013 23097
## 4    2  gwdu102    8997   dfa013   23086 dfa013 23098
## 5    3  gwdu102    8997   dfa006    5635 dfa006  5646
## 6    3  gwdu102    8997   dfa006    5635 dfa006  5675
## 7    4  gwdu102    8997   dmp053    8015 dmp053  8026
## 8    4  gwdu102    8997   dmp053    8015 dmp053  8039</code></pre>
</div>
<div id="brms" class="section level2">
<h2>brms</h2>
<p>brms is a Bayesian regression modelling software. Because we often run multiple chains in brms to assess convergence and obtain samples, more quickly, parallelisation is beneficial. brms has internal support for futures. By setting its <code>future</code> argument to true, it will run the chains according to <code>plan</code>. Because running such a model can take a lot of time, it is beneficial to offload it to a remote server or cluster.</p>
<div id="use-brms-with-my-own-data-on-lsf" class="section level3">
<h3>use brms with my own data on LSF</h3>
<p>Also showing a different way to set up the future and pass along globals and packages.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">login &lt;-<span class="st"> </span><span class="kw">tweak</span>(remote, <span class="dt">workers =</span> <span class="st">&quot;gwdu102.gwdg.de&quot;</span>, <span class="dt">user =</span> <span class="st">&#39;rarslan&#39;</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">bsub &lt;-<span class="st"> </span><span class="kw">tweak</span>(batchtools_lsf, <span class="dt">template =</span> <span class="st">&#39;lsf.tmpl&#39;</span>, </a>
<a class="sourceLine" id="cb4-3" data-line-number="3">            <span class="co"># workers = &quot;export LSF_ENVDIR=/opt/lsf/conf&quot;,</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                <span class="dt">resources =</span> <span class="kw">list</span>(<span class="dt">job.name =</span> <span class="st">&#39;brms_test&#39;</span>,</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">                                <span class="dt">log.file =</span> <span class="st">&#39;brms_test.log&#39;</span>,</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">                                <span class="dt">queue =</span> <span class="st">&#39;mpi&#39;</span>,</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">                                <span class="dt">walltime =</span> <span class="st">&#39;2:00&#39;</span>,</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">                                <span class="dt">processes =</span> <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="kw">library</span>(brms)</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">## Specify future topology</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">## login node -&gt; { cluster node (compile brms model) } -&gt; { run chains on multiple cores }</a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="kw">plan</span>(<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">  login,</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">  bsub,</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">  multicore</a>
<a class="sourceLine" id="cb4-17" data-line-number="17">))</a>
<a class="sourceLine" id="cb4-18" data-line-number="18"></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"></a>
<a class="sourceLine" id="cb4-20" data-line-number="20">mydata =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dv">100</span>), <span class="dt">y =</span> <span class="kw">rnorm</span>(<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb4-21" data-line-number="21"></a>
<a class="sourceLine" id="cb4-22" data-line-number="22">model_name &lt;-<span class="st"> &quot;mydata_model.rds&quot;</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23">fit2 <span class="op">%&lt;-%</span><span class="st"> </span>{ <span class="co"># retrieve the model if it has been fit already</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24">  <span class="cf">if</span> (<span class="kw">file.exists</span>(model_name))</a>
<a class="sourceLine" id="cb4-25" data-line-number="25">    <span class="kw">readRDS</span>(model_name)</a>
<a class="sourceLine" id="cb4-26" data-line-number="26">}</a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="cf">if</span> (<span class="kw">is.null</span>(fit2)) {</a>
<a class="sourceLine" id="cb4-28" data-line-number="28">  fit2 <span class="op">%&lt;-%</span><span class="st"> </span>{ <span class="co"># login to tardis</span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29">    model <span class="op">%&lt;-%</span><span class="st"> </span>{ <span class="co"># qsub</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30">      <span class="kw">message</span>(model_name)</a>
<a class="sourceLine" id="cb4-31" data-line-number="31">      <span class="kw">brm</span>(x <span class="op">~</span><span class="st"> </span>y, </a>
<a class="sourceLine" id="cb4-32" data-line-number="32">        <span class="dt">data =</span> mydata, </a>
<a class="sourceLine" id="cb4-33" data-line-number="33">        <span class="dt">chains =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb4-34" data-line-number="34">        <span class="dt">future =</span> <span class="ot">TRUE</span> <span class="co">#multicore</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35">        )</a>
<a class="sourceLine" id="cb4-36" data-line-number="36">    }</a>
<a class="sourceLine" id="cb4-37" data-line-number="37">    <span class="kw">saveRDS</span>(model, <span class="dt">file =</span> model_name) <span class="co"># in case we lose the connection, save the result</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38">    model</a>
<a class="sourceLine" id="cb4-39" data-line-number="39">  }</a>
<a class="sourceLine" id="cb4-40" data-line-number="40">}</a>
<a class="sourceLine" id="cb4-41" data-line-number="41"></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="co"># but the program will wait for it</span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43">fit2</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: x ~ y 
##    Data: mydata (Number of observations: 100) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1; 
##          total post-warmup samples = 4000
##     ICs: LOO = NA; WAIC = NA; R2 = NA
##  
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept    -0.09      0.10    -0.29     0.11       3263 1.00
## y             0.17      0.09    -0.02     0.36       4000 1.00
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## sigma     1.00      0.07     0.87     1.16       3583 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># don&#39;t make your plots on the cluster, make em at home</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">marginal_effects</span>(fit2)</a></code></pre></div>
<p><img src="future_GWDG_SCC_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
</div>
<div id="local-env" class="section level2">
<h2>local env</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.4.4 RC (2018-03-08 r74373)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Sierra 10.12.6
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.4/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] brms_2.2.0              ggplot2_2.2.1           Rcpp_0.12.16           
## [4] batchtools_0.9.8        data.table_1.10.4-3     debugme_1.1.0          
## [7] future.batchtools_0.6.0 listenv_0.7.0           future_1.8.0           
## 
## loaded via a namespace (and not attached):
##  [1] Brobdingnag_1.2-4    gtools_3.5.0         StanHeaders_2.17.2  
##  [4] threejs_0.3.1        shiny_1.0.5          assertthat_0.2.0    
##  [7] stats4_3.4.4         base64url_1.3        yaml_2.1.18         
## [10] progress_1.1.2       globals_0.11.0       pillar_1.2.1        
## [13] backports_1.1.2      lattice_0.20-35      glue_1.2.0          
## [16] digest_0.6.15        checkmate_1.8.5      colorspace_1.3-2    
## [19] htmltools_0.3.6      httpuv_1.3.6.2       Matrix_1.2-12       
## [22] plyr_1.8.4           dygraphs_1.1.1.4     pkgconfig_2.0.1     
## [25] rstan_2.17.3         xtable_1.8-2         mvtnorm_1.0-7       
## [28] scales_0.5.0         brew_1.0-6           tibble_1.4.2        
## [31] bayesplot_1.5.0      DT_0.4               shinyjs_1.0         
## [34] withr_2.1.2          lazyeval_0.2.1       magrittr_1.5        
## [37] crayon_1.3.4         mime_0.5             evaluate_0.10.1     
## [40] nlme_3.1-131.1       xts_0.10-1           colourpicker_1.0    
## [43] rsconnect_0.8.8      tools_3.4.4          loo_2.0.0           
## [46] prettyunits_1.0.2    matrixStats_0.53.1   stringr_1.3.0       
## [49] munsell_0.4.3        bindrcpp_0.2         compiler_3.4.4      
## [52] rlang_0.2.0          grid_3.4.4           ggridges_0.4.1      
## [55] rappdirs_0.3.1       htmlwidgets_1.0      crosstalk_1.0.0     
## [58] igraph_1.2.1         miniUI_0.1.1         labeling_0.3        
## [61] base64enc_0.1-3      rmarkdown_1.9        gtable_0.2.0        
## [64] codetools_0.2-15     inline_0.3.14        abind_1.4-5         
## [67] reshape2_1.4.3       markdown_0.8         R6_2.2.2            
## [70] gridExtra_2.3        rstantools_1.4.0     zoo_1.8-1           
## [73] knitr_1.20           bridgesampling_0.4-0 dplyr_0.7.4         
## [76] shinythemes_1.1.1    bindr_0.1.1          shinystan_2.4.0     
## [79] rprojroot_1.3-2      stringi_1.1.7        parallel_3.4.4      
## [82] coda_0.19-1</code></pre>
</div>
<div id="remote-env" class="section level2">
<h2>remote env</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">plan</span>(login)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw">value</span>(<span class="kw">future</span>({<span class="kw">sessionInfo</span>() }))</a></code></pre></div>
<pre><code>## R version 3.4.1 (2017-06-30)
## Platform: x86_64-redhat-linux-gnu (64-bit)
## Running under: Scientific Linux 7.3 (Nitrogen)
## 
## Matrix products: default
## BLAS/LAPACK: /usr/lib64/R/lib/libRblas.so
## 
## locale:
## [1] C
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## loaded via a namespace (and not attached):
## [1] compiler_3.4.1   parallel_3.4.1   listenv_0.7.0    codetools_0.2-15
## [5] digest_0.6.12    globals_0.11.0   future_1.8.0</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAidHJ5IgphdXRob3I6ICJSdWJlbiBBcnNsYW4iCmRhdGU6ICIzMCBPY3RvYmVyIDIwMTciCm91dHB1dDogaHRtbF9kb2N1bWVudAotLS0KCmBgYHtyIHNldHVwLCBpbmNsdWRlPUZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQoZWNobyA9IFRSVUUpCmBgYAoKIyMgRnV0dXJlIHBhY2thZ2UKCmBgYHtyIGxvYWR9CiMgdmlnbmV0dGUoImZ1dHVyZS0xLW92ZXJ2aWV3IikKbGlicmFyeShmdXR1cmUpCmBgYAoKIyMgR1dERyBjbHVzdGVyClRvIHJ1biBqb2JzIG9uIGEgY2x1c3RlciwgeW91IG5lZWQgdG8gdXNlIGEgam9iIHNjaGVkdWxlci4gRm9yIHRoaXMsIHlvdSBuZWVkIGEgc2Vjb25kIHBhY2thZ2UgYGZ1dHVyZS5iYXRjaHRvb2xzYC4gRnVydGhlciwgeW91IG5lZWQgdG8gY29weSBhIHRlbXBsYXRlIGZpbGUgZm9yIGpvYiBzY3JpcHRzIHRvIHRoZSBzZXJ2ZXIuCgpgYGB7cn0KbGlicmFyeSgiZnV0dXJlIikKbGlicmFyeSgibGlzdGVudiIpCmxpYnJhcnkoImZ1dHVyZS5iYXRjaHRvb2xzIikKbGlicmFyeShkZWJ1Z21lKQpTeXMuc2V0ZW52KERFQlVHTUU9J2JhdGNodG9vbHMnKQpsaWJyYXJ5KGJhdGNodG9vbHMpCgojIyBTZXQgdXAgYWNjZXNzIHRvIHJlbW90ZSBsb2dpbiBub2RlCiMgbG9naW5fdnBuIDwtIHR3ZWFrKHJlbW90ZSwgd29ya2VycyA9ICJyYXJzbGFuQGxvZ2luLmd3ZGcuZGUiKSAjIGRvZXNuJ3Qgd29yayBiZWNhdXNlIFIgbm90IGluc3RhbGxlZApsb2dpbiA8LSB0d2VhayhyZW1vdGUsIHdvcmtlcnMgPSAiZ3dkdTEwMi5nd2RnLmRlIiwgdXNlciA9ICdyYXJzbGFuJykKYnN1YiA8LSB0d2VhayhiYXRjaHRvb2xzX2xzZiwgdGVtcGxhdGUgPSAnbHNmLnRtcGwnLCAKICAgICAgICAgICAgIyB3b3JrZXJzID0gImV4cG9ydCBMU0ZfRU5WRElSPS9vcHQvbHNmL2NvbmYiLAogICAgICAgICAgICAgICAgcmVzb3VyY2VzID0gbGlzdChqb2IubmFtZSA9ICd0ZXN0MScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9nLmZpbGUgPSAnYmxhYWEyLmxvZycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVldWUgPSAnbXBpJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWxsdGltZSA9ICcxOjAwJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZXMgPSA0KSkKCiMjIFNwZWNpZnkgZnV0dXJlIHRvcG9sb2d5CiMjIGxvZ2luIG5vZGUgLT4geyBjbHVzdGVyIG5vZGVzIH0gLT4geyBtdWx0aXBsZSBjb3JlcyB9CnBsYW4obGlzdCgKICBsb2dpbiwKICBic3ViLAogIG11bHRpY29yZQopKQojIGRlbW8oIm1hbmRlbGJyb3QiLCBwYWNrYWdlID0gImZ1dHVyZSIsIGFzayA9IEZBTFNFKQoKeCAlPC0lIHsKICB0aG9zdCA8LSBTeXMuaW5mbygpW1sibm9kZW5hbWUiXV0KICB0cGlkIDwtIFN5cy5nZXRwaWQoKQogICMgc2V0X2d3ZGdfZW52KCkKICB5IDwtIGxpc3RlbnYoKQogIGZvciAodGFzayBpbiAxOjQpIHsKICAgICMjIChiKSBUaGlzIHdpbGwgYmUgZXZhbHVhdGVkIG9uIGEgY29tcHV0ZSBub2RlIG9uIHRoZSBjbHVzdGVyCiAgICB5W1t0YXNrXV0gJTwtJSB7CiAgICAgIG1ob3N0IDwtIFN5cy5pbmZvKClbWyJub2RlbmFtZSJdXQogICAgICBtcGlkIDwtIFN5cy5nZXRwaWQoKQogICAgICB6IDwtIGxpc3RlbnYoKQogICAgICBmb3IgKGpqIGluIDE6MikgewogICAgICAgICMjIChjKSBUaGVzZSB3aWxsIGJlIGV2YWx1YXRlZCBpbiBzZXBhcmF0ZSBwcm9jZXNzZXMgb24gdGhlIHNhbWUgY29tcHV0ZSBub2RlCiAgICAgICAgeltbampdXSAlPC0lIGRhdGEuZnJhbWUodGFzayA9IHRhc2ssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wLmhvc3QgPSB0aG9zdCwgdG9wLnBpZCA9IHRwaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlkLmhvc3QgPSBtaG9zdCwgbWlkLnBpZCA9IG1waWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaG9zdCA9IFN5cy5pbmZvKClbWyJub2RlbmFtZSJdXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaWQgPSBTeXMuZ2V0cGlkKCkpCiAgICAgIH0KICAgICAgUmVkdWNlKHJiaW5kLCB6KQogICAgfQogIH0KICBSZWR1Y2UocmJpbmQsIHkpCn0KCnByaW50KHgpCgpgYGAKCiMjIGJybXMKYnJtcyBpcyBhIEJheWVzaWFuIHJlZ3Jlc3Npb24gbW9kZWxsaW5nIHNvZnR3YXJlLiBCZWNhdXNlIHdlIG9mdGVuIHJ1biBtdWx0aXBsZSBjaGFpbnMgaW4gYnJtcyB0byBhc3Nlc3MgY29udmVyZ2VuY2UgYW5kIG9idGFpbiBzYW1wbGVzLCBtb3JlIHF1aWNrbHksIHBhcmFsbGVsaXNhdGlvbiBpcyBiZW5lZmljaWFsLiBicm1zIGhhcyBpbnRlcm5hbCBzdXBwb3J0IGZvciBmdXR1cmVzLiBCeSBzZXR0aW5nIGl0cyBgZnV0dXJlYCBhcmd1bWVudCB0byB0cnVlLCBpdCB3aWxsIHJ1biB0aGUgY2hhaW5zIGFjY29yZGluZyB0byBgcGxhbmAuCkJlY2F1c2UgcnVubmluZyBzdWNoIGEgbW9kZWwgY2FuIHRha2UgYSBsb3Qgb2YgdGltZSwgaXQgaXMgYmVuZWZpY2lhbCB0byBvZmZsb2FkIGl0IHRvIGEgcmVtb3RlIHNlcnZlciBvciBjbHVzdGVyLgoKIyMjIHVzZSBicm1zIHdpdGggbXkgb3duIGRhdGEgb24gTFNGCkFsc28gc2hvd2luZyBhIGRpZmZlcmVudCB3YXkgdG8gc2V0IHVwIHRoZSBmdXR1cmUgYW5kIHBhc3MgYWxvbmcgZ2xvYmFscyBhbmQgcGFja2FnZXMuCgpgYGB7cn0KbG9naW4gPC0gdHdlYWsocmVtb3RlLCB3b3JrZXJzID0gImd3ZHUxMDIuZ3dkZy5kZSIsIHVzZXIgPSAncmFyc2xhbicpCmJzdWIgPC0gdHdlYWsoYmF0Y2h0b29sc19sc2YsIHRlbXBsYXRlID0gJ2xzZi50bXBsJywgCiAgICAgICAgICAgICMgd29ya2VycyA9ICJleHBvcnQgTFNGX0VOVkRJUj0vb3B0L2xzZi9jb25mIiwKICAgICAgICAgICAgICAgIHJlc291cmNlcyA9IGxpc3Qoam9iLm5hbWUgPSAnYnJtc190ZXN0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2cuZmlsZSA9ICdicm1zX3Rlc3QubG9nJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWV1ZSA9ICdtcGknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhbGx0aW1lID0gJzI6MDAnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlcyA9IDQpKQpsaWJyYXJ5KGJybXMpCgojIyBTcGVjaWZ5IGZ1dHVyZSB0b3BvbG9neQojIyBsb2dpbiBub2RlIC0+IHsgY2x1c3RlciBub2RlIChjb21waWxlIGJybXMgbW9kZWwpIH0gLT4geyBydW4gY2hhaW5zIG9uIG11bHRpcGxlIGNvcmVzIH0KcGxhbihsaXN0KAogIGxvZ2luLAogIGJzdWIsCiAgbXVsdGljb3JlCikpCgoKbXlkYXRhID0gZGF0YS5mcmFtZSh4ID0gcm5vcm0oMTAwKSwgeSA9IHJub3JtKDEwMCkpCgptb2RlbF9uYW1lIDwtICJteWRhdGFfbW9kZWwucmRzIgpmaXQyICU8LSUgeyAjIHJldHJpZXZlIHRoZSBtb2RlbCBpZiBpdCBoYXMgYmVlbiBmaXQgYWxyZWFkeQogIGlmIChmaWxlLmV4aXN0cyhtb2RlbF9uYW1lKSkKICAgIHJlYWRSRFMobW9kZWxfbmFtZSkKfQppZiAoaXMubnVsbChmaXQyKSkgewogIGZpdDIgJTwtJSB7ICMgbG9naW4gdG8gdGFyZGlzCiAgICBtb2RlbCAlPC0lIHsgIyBxc3ViCiAgICAgIG1lc3NhZ2UobW9kZWxfbmFtZSkKICAgICAgYnJtKHggfiB5LCAKICAgICAgICBkYXRhID0gbXlkYXRhLCAKICAgICAgICBjaGFpbnMgPSA0LAogICAgICAgIGZ1dHVyZSA9IFRSVUUgI211bHRpY29yZQogICAgICAgICkKICAgIH0KICAgIHNhdmVSRFMobW9kZWwsIGZpbGUgPSBtb2RlbF9uYW1lKSAjIGluIGNhc2Ugd2UgbG9zZSB0aGUgY29ubmVjdGlvbiwgc2F2ZSB0aGUgcmVzdWx0CiAgICBtb2RlbAogIH0KfQoKIyBidXQgdGhlIHByb2dyYW0gd2lsbCB3YWl0IGZvciBpdApmaXQyCgojIGRvbid0IG1ha2UgeW91ciBwbG90cyBvbiB0aGUgY2x1c3RlciwgbWFrZSBlbSBhdCBob21lCm1hcmdpbmFsX2VmZmVjdHMoZml0MikKYGBgCgojIyBsb2NhbCBlbnYKYGBge3J9CnNlc3Npb25JbmZvKCkKYGBgCgojIyByZW1vdGUgZW52CmBgYHtyfQpwbGFuKGxvZ2luKQoKdmFsdWUoZnV0dXJlKHtzZXNzaW9uSW5mbygpIH0pKQpgYGAKCg==</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
